from __future__ import annotations

import json
from collections.abc import Sequence
from dataclasses import asdict, is_dataclass
from functools import cache
from importlib import resources
@ -46,6 +47,16 @@ def _to_obj(x: object) -> object:
    return x


def _prune_none(obj: object) -> object:
    """Recursively drop dict keys with None values.

    Also normalizes tuples to lists so the JSON Schema validator sees
    Python `list` for schema `type: "array"`.
    """
    if isinstance(obj, dict):
        mapping = cast("dict[str, object]", obj)
        out: dict[str, object] = {}
        for k, v in mapping.items():
            if v is None:
                continue
            out[k] = _prune_none(v)
        return out
    if isinstance(obj, tuple):
        return [_prune_none(v) for v in obj]
    if isinstance(obj, list):
        return [_prune_none(v) for v in obj]
    return obj

